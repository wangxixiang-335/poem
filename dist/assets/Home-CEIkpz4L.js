import{h as ce,d as de,r as g,c as M,k as ue,_ as ve,b as c,f as S,e,g as he,v as me,l as U,t as l,F as j,m as A,w as O,j as d,a as xe,u as Oe,p as Be,q as Re,n as z,i as X,s as re}from"./index-CSK4OVOp.js";function Te(u,s){return new Promise((n,t)=>{const F=setTimeout(()=>{const b={mood:`ã€Š${u.title}ã€‹è¥é€ äº†ä¸€ç§${u.dynasty==="å”ä»£"?"æ¸…æ–°æ·¡é›…":"å©‰çº¦æ·±æ²‰"}çš„æ„å¢ƒã€‚ä½œè€…${u.author}é€šè¿‡ç»†è…»çš„æƒ…æ„Ÿè¡¨è¾¾ï¼Œå°†${u.dynasty==="å”ä»£"?"å¯¹è‡ªç„¶çš„çƒ­çˆ±ä¸äººç”Ÿçš„æ„Ÿæ‚Ÿ":"å†…å¿ƒçš„æ€è€ƒä¸æƒ…æ„Ÿçš„æ³¢æ¾œ"}å¨“å¨“é“æ¥ï¼Œè®©è¯»è€…ä»¿ä½›ç½®èº«å…¶ä¸­ï¼Œæ„Ÿå—åˆ°é‚£ä»½${u.title.includes("æ€")?"æ€ä¹¡ä¹‹æƒ…":u.title.includes("æ˜¥")?"æ˜¥æ—¥ä¹‹ç¾":"äººç”Ÿæ„Ÿæ…¨"}ã€‚`,rhetoric:`è¿™é¦–è¯—è¿ç”¨äº†å¤šç§ä¿®è¾æ‰‹æ³•ï¼š${u.content.includes("æ˜æœˆ")?"ä»¥æœˆä¸ºæ„è±¡ï¼Œå¯“æƒ…äºæ™¯":""}${u.content.includes("èŠ±")?"å€ŸèŠ±å–»äººï¼Œæƒ…æ™¯äº¤è":""}${u.content.includes("æ°´")||u.content.includes("æ±Ÿ")?"ä»¥æ°´å–»æƒ…ï¼ŒåŠ¨é™ç»“åˆ":""}ã€‚è¯—äººå·§å¦™åœ°è¿ç”¨${u.dynasty==="å®‹ä»£"?"å…¸å‹çš„å®‹è¯æ‰‹æ³•ï¼Œè¯å¥ä¼˜ç¾ï¼ŒéŸµå¾‹å’Œè°":"å”è¯—çš„æ ¼å¾‹ä¸¥è°¨ï¼Œå¯¹ä»—å·¥æ•´"}ï¼Œä½¿å¾—æ•´é¦–è¯—è¯»æ¥æœ—æœ—ä¸Šå£ï¼Œæ„å¢ƒæ·±è¿œã€‚`,background:`${u.title}åˆ›ä½œäº${u.dynasty}ï¼Œæ­£å€¼${u.dynasty==="å”ä»£"?"å”æœæ–‡åŒ–ç¹è£ï¼Œè¯—æ­Œåˆ›ä½œè¾¾åˆ°å·…å³°":u.dynasty==="å®‹ä»£"?"å®‹ä»£æ–‡äººé›…å£«ç››è¡Œï¼Œè¯é£å©‰çº¦":"æ–‡å­¦å‘å±•çš„é‡è¦æ—¶æœŸ"}ã€‚${u.author}ä½œä¸º${u.dynasty}è‘—åè¯—äººï¼Œå…¶ä½œå“å¾€å¾€åæ˜ äº†å½“æ—¶çš„ç¤¾ä¼šé£è²Œä¸ä¸ªäººæƒ…æ€€ã€‚è¿™é¦–è¯—çš„åˆ›ä½œèƒŒæ™¯å¯èƒ½ä¸ä½œè€…çš„${u.title.includes("æ€")?"æ€ä¹¡ç»å†":u.title.includes("æ˜¥")?"æ˜¥æ—¥æ„Ÿæ€€":"äººç”Ÿæ„Ÿæ‚Ÿ"}å¯†åˆ‡ç›¸å…³ã€‚`,commentary:`ã€Š${u.title}ã€‹å ªç§°${u.dynasty}è¯—æ­Œçš„ç»å…¸ä¹‹ä½œã€‚å…¨è¯—ç»“æ„ä¸¥è°¨ï¼Œå±‚æ¬¡åˆ†æ˜ï¼Œä»${u.content.split("ï¼Œ")[0]||"å¼€ç¯‡"}å…¥æ‰‹ï¼Œé€æ­¥å±•å¼€æƒ…æ„Ÿçš„æŠ’å‘ã€‚${u.author}ä»¥å…¶æ·±åšçš„æ–‡å­¦åŠŸåº•å’Œæ•é”çš„æƒ…æ„Ÿè§¦è§‰ï¼Œå°†${u.title.includes("é™")?"é™è°§çš„å¤œæ™š":u.title.includes("æ˜¥")?"æ˜¥æ—¥çš„ç¾å¥½":"äººç”Ÿçš„æ„Ÿæ‚Ÿ"}æç»˜å¾—æ·‹æ¼“å°½è‡´ã€‚è¿™é¦–è¯—ä¸ä»…åœ¨å½“æ—¶å¹¿ä¸ºä¼ é¢‚ï¼Œè‡³ä»Šä»è¢«äººä»¬æ‰€å–œçˆ±ï¼Œè¶³è§å…¶è‰ºæœ¯ä»·å€¼å’Œæ–‡å­¦åœ°ä½ã€‚`};n(b)},1500);s&&s.addEventListener("abort",()=>{clearTimeout(F),t(new Error("è¯·æ±‚å·²å–æ¶ˆ"))})})}const Me=[{id:"libai_1",title:"é™å¤œæ€",author:"æç™½",dynasty:"å”ä»£",content:"åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚",preview:"åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg"},{id:"libai_2",title:"æœ›åºå±±ç€‘å¸ƒ",author:"æç™½",dynasty:"å”ä»£",content:"æ—¥ç…§é¦™ç‚‰ç”Ÿç´«çƒŸï¼Œé¥çœ‹ç€‘å¸ƒæŒ‚å‰å·ã€‚é£æµç›´ä¸‹ä¸‰åƒå°ºï¼Œç–‘æ˜¯é“¶æ²³è½ä¹å¤©ã€‚",preview:"æ—¥ç…§é¦™ç‚‰ç”Ÿç´«çƒŸï¼Œé¥çœ‹ç€‘å¸ƒæŒ‚å‰å·ã€‚é£æµç›´ä¸‹ä¸‰åƒå°ºï¼Œç–‘æ˜¯é“¶æ²³è½ä¹å¤©ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/437f5006c8faaf74d6d7d4197e1d9482.jpg"},{id:"libai_3",title:"æ—©å‘ç™½å¸åŸ",author:"æç™½",dynasty:"å”ä»£",content:"æœè¾ç™½å¸å½©äº‘é—´ï¼Œåƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜ã€‚ä¸¤å²¸çŒ¿å£°å•¼ä¸ä½ï¼Œè½»èˆŸå·²è¿‡ä¸‡é‡å±±ã€‚",preview:"æœè¾ç™½å¸å½©äº‘é—´ï¼Œåƒé‡Œæ±Ÿé™µä¸€æ—¥è¿˜ã€‚ä¸¤å²¸çŒ¿å£°å•¼ä¸ä½ï¼Œè½»èˆŸå·²è¿‡ä¸‡é‡å±±ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg"},{id:"dufu_1",title:"æ˜¥æœ›",author:"æœç”«",dynasty:"å”ä»£",content:"å›½ç ´å±±æ²³åœ¨ï¼ŒåŸæ˜¥è‰æœ¨æ·±ã€‚æ„Ÿæ—¶èŠ±æº…æ³ªï¼Œæ¨åˆ«é¸ŸæƒŠå¿ƒã€‚çƒ½ç«è¿ä¸‰æœˆï¼Œå®¶ä¹¦æŠµä¸‡é‡‘ã€‚ç™½å¤´æ”æ›´çŸ­ï¼Œæµ‘æ¬²ä¸èƒœç°ªã€‚",preview:"å›½ç ´å±±æ²³åœ¨ï¼ŒåŸæ˜¥è‰æœ¨æ·±ã€‚æ„Ÿæ—¶èŠ±æº…æ³ªï¼Œæ¨åˆ«é¸ŸæƒŠå¿ƒã€‚çƒ½ç«è¿ä¸‰æœˆï¼Œå®¶ä¹¦æŠµä¸‡é‡‘ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/43e7125fe4023d89a1774e4416e1ace4.jpg"},{id:"dufu_2",title:"ç™»é«˜",author:"æœç”«",dynasty:"å”ä»£",content:"é£æ€¥å¤©é«˜çŒ¿å•¸å“€ï¼Œæ¸šæ¸…æ²™ç™½é¸Ÿé£å›ã€‚æ— è¾¹è½æœ¨è§è§ä¸‹ï¼Œä¸å°½é•¿æ±Ÿæ»šæ»šæ¥ã€‚",preview:"é£æ€¥å¤©é«˜çŒ¿å•¸å“€ï¼Œæ¸šæ¸…æ²™ç™½é¸Ÿé£å›ã€‚æ— è¾¹è½æœ¨è§è§ä¸‹ï¼Œä¸å°½é•¿æ±Ÿæ»šæ»šæ¥ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/f0be731204399b0b196cea3d7505fdd2.jpg"},{id:"sushi_1",title:"æ°´è°ƒæ­Œå¤´",author:"è‹è½¼",dynasty:"å®‹ä»£",content:"æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ã€‚æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚",preview:"æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ã€‚æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡...",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg"},{id:"sushi_2",title:"å¿µå¥´å¨‡Â·èµ¤å£æ€€å¤",author:"è‹è½¼",dynasty:"å®‹ä»£",content:"å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©ã€‚æ•…å’è¥¿è¾¹ï¼Œäººé“æ˜¯ï¼Œä¸‰å›½å‘¨éƒèµ¤å£ã€‚",preview:"å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©ã€‚æ•…å’è¥¿è¾¹ï¼Œäººé“æ˜¯ï¼Œä¸‰å›½å‘¨éƒèµ¤å£ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/437f5006c8faaf74d6d7d4197e1d9482.jpg"},{id:"wangwei_1",title:"ç›¸æ€",author:"ç‹ç»´",dynasty:"å”ä»£",content:"çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚æ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚",preview:"çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚æ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg"},{id:"baijuyi_1",title:"çµç¶è¡Œ",author:"ç™½å±…æ˜“",dynasty:"å”ä»£",content:"æµ”é˜³æ±Ÿå¤´å¤œé€å®¢ï¼Œæ«å¶è»èŠ±ç§‹ç‘Ÿç‘Ÿã€‚ä¸»äººä¸‹é©¬å®¢åœ¨èˆ¹ï¼Œä¸¾é…’æ¬²é¥®æ— ç®¡å¼¦ã€‚",preview:"æµ”é˜³æ±Ÿå¤´å¤œé€å®¢ï¼Œæ«å¶è»èŠ±ç§‹ç‘Ÿç‘Ÿã€‚ä¸»äººä¸‹é©¬å®¢åœ¨èˆ¹ï¼Œä¸¾é…’æ¬²é¥®æ— ç®¡å¼¦ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/43e7125fe4023d89a1774e4416e1ace4.jpg"},{id:"lishangyin_1",title:"é”¦ç‘Ÿ",author:"æå•†éš",dynasty:"å”ä»£",content:"é”¦ç‘Ÿæ— ç«¯äº”åå¼¦ï¼Œä¸€å¼¦ä¸€æŸ±æ€åå¹´ã€‚åº„ç”Ÿæ™“æ¢¦è¿·è´è¶ï¼Œæœ›å¸æ˜¥å¿ƒæ‰˜æœé¹ƒã€‚",preview:"é”¦ç‘Ÿæ— ç«¯äº”åå¼¦ï¼Œä¸€å¼¦ä¸€æŸ±æ€åå¹´ã€‚åº„ç”Ÿæ™“æ¢¦è¿·è´è¶ï¼Œæœ›å¸æ˜¥å¿ƒæ‰˜æœé¹ƒã€‚",image:"https://ai-public.mastergo.com/ai/img_res/f0be731204399b0b196cea3d7505fdd2.jpg"},{id:"xinqiji_1",title:"é’ç‰æ¡ˆÂ·å…ƒå¤•",author:"è¾›å¼ƒç–¾",dynasty:"å®‹ä»£",content:"ä¸œé£å¤œæ”¾èŠ±åƒæ ‘ï¼Œæ›´å¹è½ã€æ˜Ÿå¦‚é›¨ã€‚å®é©¬é›•è½¦é¦™æ»¡è·¯ã€‚å‡¤ç®«å£°åŠ¨ï¼Œç‰å£¶å…‰è½¬ï¼Œä¸€å¤œé±¼é¾™èˆã€‚",preview:"ä¸œé£å¤œæ”¾èŠ±åƒæ ‘ï¼Œæ›´å¹è½ã€æ˜Ÿå¦‚é›¨ã€‚å®é©¬é›•è½¦é¦™æ»¡è·¯ã€‚å‡¤ç®«å£°åŠ¨ï¼Œç‰å£¶å…‰è½¬...",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg"},{id:"liqingzhao_1",title:"å£°å£°æ…¢",author:"ææ¸…ç…§",dynasty:"å®‹ä»£",content:"å¯»å¯»è§…è§…ï¼Œå†·å†·æ¸…æ¸…ï¼Œå‡„å‡„æƒ¨æƒ¨æˆšæˆšã€‚ä¹æš–è¿˜å¯’æ—¶å€™ï¼Œæœ€éš¾å°†æ¯ã€‚",preview:"å¯»å¯»è§…è§…ï¼Œå†·å†·æ¸…æ¸…ï¼Œå‡„å‡„æƒ¨æƒ¨æˆšæˆšã€‚ä¹æš–è¿˜å¯’æ—¶å€™ï¼Œæœ€éš¾å°†æ¯ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/437f5006c8faaf74d6d7d4197e1d9482.jpg"},{id:"mazhiyuan_1",title:"å¤©å‡€æ²™Â·ç§‹æ€",author:"é©¬è‡´è¿œ",dynasty:"å…ƒä»£",content:"æ¯è—¤è€æ ‘æ˜é¸¦ï¼Œå°æ¡¥æµæ°´äººå®¶ï¼Œå¤é“è¥¿é£ç˜¦é©¬ã€‚å¤•é˜³è¥¿ä¸‹ï¼Œæ–­è‚ äººåœ¨å¤©æ¶¯ã€‚",preview:"æ¯è—¤è€æ ‘æ˜é¸¦ï¼Œå°æ¡¥æµæ°´äººå®¶ï¼Œå¤é“è¥¿é£ç˜¦é©¬ã€‚å¤•é˜³è¥¿ä¸‹ï¼Œæ–­è‚ äººåœ¨å¤©æ¶¯ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg"},{id:"xuzhimo_1",title:"å†åˆ«åº·æ¡¥",author:"å¾å¿—æ‘©",dynasty:"ç°ä»£",content:"è½»è½»çš„æˆ‘èµ°äº†ï¼Œæ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼›æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚",preview:"è½»è½»çš„æˆ‘èµ°äº†ï¼Œæ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼›æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/43e7125fe4023d89a1774e4416e1ace4.jpg"}];function le(u,s){return new Promise((n,t)=>{const F=setTimeout(()=>{const b=u.keyword.toLowerCase().trim(),m=Me.filter(f=>!!(f.title.toLowerCase().includes(b)||f.author.toLowerCase().includes(b)||f.content.toLowerCase().includes(b)||f.dynasty.toLowerCase().includes(b))),k=u.page||1,w=u.limit||10,C=(k-1)*w,D=C+w,E={poems:m.slice(C,D),total:m.length,page:k,limit:w};n(E)},500);s&&s.addEventListener("abort",()=>{clearTimeout(F),t(new Error("æœç´¢å·²å–æ¶ˆ"))})})}const x=ce;class T{static async getAll(s){try{const n=await x.get("/poems",{params:s});if(n.success)return n.data;throw new Error(n.message||"è·å–è¯—è¯åˆ—è¡¨å¤±è´¥")}catch(n){throw console.error("è·å–è¯—è¯åˆ—è¡¨å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async getById(s){try{const n=await x.get(`/poems/${s}`);if(n.success)return n.data;throw new Error(n.message||"è·å–è¯—è¯è¯¦æƒ…å¤±è´¥")}catch(n){throw console.error("è·å–è¯—è¯è¯¦æƒ…å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async create(s){try{const n=await x.post("/poems",s);if(n.success)return n.data;throw new Error(n.message||"åˆ›å»ºè¯—è¯å¤±è´¥")}catch(n){throw console.error("åˆ›å»ºè¯—è¯å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async createBatch(s){try{const n=await x.post("/poems/batch",{poems:s});if(n.success)return n.data;throw new Error(n.message||"æ‰¹é‡åˆ›å»ºè¯—è¯å¤±è´¥")}catch(n){throw console.error("æ‰¹é‡åˆ›å»ºè¯—è¯å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async update(s,n){try{const t=await x.put(`/poems/${s}`,n);if(t.success)return t.data;throw new Error(t.message||"æ›´æ–°è¯—è¯å¤±è´¥")}catch(t){throw console.error("æ›´æ–°è¯—è¯å¤±è´¥:",t),new Error(t.message||"ç½‘ç»œé”™è¯¯")}}static async toggleFavorite(s){try{const n=await x.patch(`/poems/${s}/favorite`);if(n.success)return n.data;throw new Error(n.message||"åˆ‡æ¢æ”¶è—çŠ¶æ€å¤±è´¥")}catch(n){throw console.error("åˆ‡æ¢æ”¶è—çŠ¶æ€å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async delete(s){try{const n=await x.delete(`/poems/${s}`);if(n.success)return n.data;throw new Error(n.message||"åˆ é™¤è¯—è¯å¤±è´¥")}catch(n){throw console.error("åˆ é™¤è¯—è¯å¤±è´¥:",n),new Error(n.message||"ç½‘ç»œé”™è¯¯")}}static async getFavorites(){try{const s=await x.get("/poems/favorites/list");if(s.success)return s.data;throw new Error(s.message||"è·å–æ”¶è—åˆ—è¡¨å¤±è´¥")}catch(s){throw console.error("è·å–æ”¶è—åˆ—è¡¨å¤±è´¥:",s),new Error(s.message||"ç½‘ç»œé”™è¯¯")}}static async search(s){return this.getAll({search:s})}static async getByDynasty(s){return this.getAll({dynasty:s})}static async getStats(){try{const s=await x.get("/poems/stats/overview");if(s.success)return s.data;throw new Error(s.message||"è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥")}catch(s){throw console.error("è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:",s),new Error(s.message||"ç½‘ç»œé”™è¯¯")}}static async checkConnection(){try{return(await ce.get("/health")).success===!0}catch(s){return console.error("æœåŠ¡å™¨è¿æ¥æ£€æŸ¥å¤±è´¥:",s),!1}}}const Ke=de({__name:"OnlineSearch",props:{show:{type:Boolean,required:!0}},emits:["close","add-poems"],setup(u,{expose:s,emit:n}){s();const t=u,F=n,b=g(""),m=g(!1),k=g([]),w=g(0),C=g(1),D=g(10),h=g(!1),E=g([]),f=g(null),a=M(()=>k.value.length<w.value),v=async()=>{if(!(!b.value.trim()||m.value)){f.value&&f.value.abort(),f.value=new AbortController,m.value=!0,h.value=!0,C.value=1,k.value=[],E.value=[];try{const y=await le({keyword:b.value.trim(),page:C.value,limit:D.value},f.value.signal),P="data"in y?y.data:y;k.value=P.poems,w.value=P.total}catch(y){y.message!=="æœç´¢å·²å–æ¶ˆ"&&console.error("æœç´¢å¤±è´¥:",y)}finally{m.value=!1}}},L=async()=>{if(!(!a.value||m.value)){m.value=!0,C.value++;try{const y=await le({keyword:b.value.trim(),page:C.value,limit:D.value}),P="data"in y?y.data:y;k.value.push(...P.poems)}catch(y){console.error("åŠ è½½æ›´å¤šå¤±è´¥:",y),C.value--}finally{m.value=!1}}},K=y=>{E.value.includes(y.id)||(E.value.push(y.id),F("add-poems",[y]))};ue(()=>{f.value&&f.value.abort()});const B={props:t,emit:F,searchKeyword:b,loading:m,searchResults:k,totalResults:w,currentPage:C,currentLimit:D,hasSearched:h,addedPoemIds:E,abortController:f,canLoadMore:a,handleSearch:v,loadMore:L,handleAddPoem:K};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),qe={class:"search-container"},ze={class:"search-header"},Ue={class:"search-form"},Ve={class:"search-input-group"},Ne=["disabled"],He={key:0,class:"search-results"},Qe={key:0,class:"loading"},Je={key:1,class:"results-list"},Ge={class:"results-header"},We={class:"poem-info"},Xe={class:"poem-header"},Ye={class:"poem-title"},Ze={class:"poem-author"},$e={class:"poem-preview"},et={class:"poem-actions"},tt=["onClick","disabled"],st={key:0,class:"pagination"},ot=["disabled"],at={key:1,class:"no-results"},it={key:2,class:"search-tips"};function nt(u,s,n,t,F,b){return n.show?(d(),c("div",{key:0,class:"online-search-modal",onClick:s[2]||(s[2]=O(m=>u.$emit("close"),["self"]))},[e("div",qe,[e("div",ze,[s[3]||(s[3]=e("h3",null,"åœ¨çº¿æœç´¢è¯—è¯",-1)),e("button",{class:"close-btn",onClick:s[0]||(s[0]=m=>u.$emit("close"))},"Ã—")]),e("div",Ue,[e("div",Ve,[he(e("input",{"onUpdate:modelValue":s[1]||(s[1]=m=>t.searchKeyword=m),type:"text",placeholder:"è¯·è¾“å…¥è¯—è¯æ ‡é¢˜ã€ä½œè€…æˆ–å…³é”®è¯",class:"search-input",onKeyup:U(t.handleSearch,["enter"])},null,544),[[me,t.searchKeyword]]),e("button",{class:"search-btn",onClick:t.handleSearch,disabled:t.loading||!t.searchKeyword.trim()},l(t.loading?"æœç´¢ä¸­...":"æœç´¢"),9,Ne)])]),t.searchResults.length>0||t.loading?(d(),c("div",He,[t.loading?(d(),c("div",Qe,[...s[4]||(s[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"æ­£åœ¨æœç´¢è¯—è¯...",-1)])])):(d(),c("div",Je,[e("div",Ge,[e("span",null,"æ‰¾åˆ° "+l(t.totalResults)+" é¦–ç›¸å…³è¯—è¯",1)]),(d(!0),c(j,null,A(t.searchResults,m=>(d(),c("div",{key:m.id,class:"result-item"},[e("div",We,[e("div",Xe,[e("h4",Ye,l(m.title),1),e("span",Ze,l(m.author)+" Â· "+l(m.dynasty),1)]),e("p",$e,l(m.preview),1)]),e("div",et,[e("button",{class:"add-btn",onClick:k=>t.handleAddPoem(m),disabled:t.addedPoemIds.includes(m.id)},l(t.addedPoemIds.includes(m.id)?"å·²æ·»åŠ ":"æ·»åŠ åˆ°ä¸»é¡µ"),9,tt)])]))),128)),t.totalResults>t.currentLimit?(d(),c("div",st,[e("button",{class:"page-btn",onClick:t.loadMore,disabled:t.loading}," åŠ è½½æ›´å¤š ",8,ot)])):S("",!0)]))])):t.hasSearched&&!t.loading?(d(),c("div",at,[...s[5]||(s[5]=[e("p",null,"æœªæ‰¾åˆ°ç›¸å…³è¯—è¯ï¼Œè¯·å°è¯•å…¶ä»–å…³é”®è¯",-1)])])):S("",!0),t.hasSearched?S("",!0):(d(),c("div",it,[...s[6]||(s[6]=[e("h4",null,"æœç´¢æç¤º",-1),e("ul",null,[e("li",null,'å¯ä»¥æœç´¢è¯—è¯æ ‡é¢˜ï¼Œå¦‚"é™å¤œæ€"ã€"æœ›åºå±±ç€‘å¸ƒ"'),e("li",null,'å¯ä»¥æœç´¢ä½œè€…å§“åï¼Œå¦‚"æç™½"ã€"æœç”«"'),e("li",null,'å¯ä»¥æœç´¢è¯—è¯å†…å®¹å…³é”®è¯ï¼Œå¦‚"æœˆäº®"ã€"æ˜¥å¤©"')],-1)])]))])])):S("",!0)}const rt=ve(Ke,[["render",nt],["__scopeId","data-v-4f07c5bd"],["__file","D:/æ‚ç‰©/peom/src/components/OnlineSearch.vue"]]),lt=de({__name:"Home",setup(u,{expose:s}){s();const n=xe(),t=Oe(),F=()=>{n.logout(),t.push("/login")},b=g([{image:"https://ai-public.mastergo.com/ai/img_res/23776e3560960f7d99c31016d8ac9358.jpg",line:"å±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘ã€‚",author:"é™†æ¸¸ã€Šæ¸¸å±±è¥¿æ‘ã€‹"},{image:"https://ai-public.mastergo.com/ai/img_res/e2b49700f4f05ac9961717d8205941f6.jpg",line:"å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©ã€‚",author:"è‹è½¼ã€Šå¿µå¥´å¨‡Â·èµ¤å£æ€€å¤ã€‹"},{image:"https://ai-public.mastergo.com/ai/img_res/506bd9ac37829c9464c75b316c4224db.jpg",line:"ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚",author:"æç™½ã€Šé™å¤œæ€ã€‹"}]),m=g([{name:"å”è¯—",description:"å”ä»£è¯—æ­Œï¼Œæ ¼å¾‹ä¸¥è°¨ï¼Œæ„å¢ƒæ·±è¿œ",icon:"ğŸ“œ"},{name:"å®‹è¯",description:"å®‹ä»£è¯ç‰Œï¼Œå©‰çº¦è±ªæ”¾ï¼ŒéŸ³å¾‹ä¼˜ç¾",icon:"ğŸµ"},{name:"å…ƒæ›²",description:"å…ƒä»£æ•£æ›²ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œå¯Œæœ‰ç”Ÿæ´»æ°”æ¯",icon:"ğŸ­"},{name:"å¤é£",description:"å¤ä»£é£æ ¼è¯—æ­Œï¼ŒåŒ…æ‹¬æ±‰é­å…­æœä½œå“",icon:"ğŸ›ï¸"},{name:"ç°ä»£è¯—",description:"ç°å½“ä»£è¯—æ­Œï¼Œå½¢å¼è‡ªç”±ï¼Œæƒ…æ„ŸçœŸæŒš",icon:"ğŸ†•"},{name:"ä¹åºœ",description:"æ±‰é­ä¹åºœè¯—ï¼Œæ°‘é—´æ­Œè°£ï¼Œå™äº‹æ€§å¼º",icon:"ğŸ¶"},{name:"ç»å¥",description:"å››å¥è¯—ä½“ï¼Œè¨€ç®€æ„èµ…ï¼Œæ„å¢ƒå®Œæ•´",icon:"âœ‚ï¸"},{name:"å¾‹è¯—",description:"å…«å¥è¯—ä½“ï¼Œå¯¹ä»—å·¥æ•´ï¼Œæ ¼å¾‹ä¸¥è°¨",icon:"âš–ï¸"}]),k=g(0),w=g(!1),C=g(!0),D=g(null),h=g([]),E=async()=>{try{console.log("ğŸ”„ å¼€å§‹åŠ è½½è¯—è¯æ•°æ®..."),C.value=!0,D.value=null,console.log("ğŸ” æ£€æŸ¥æœåŠ¡å™¨è¿æ¥...");const o=await T.checkConnection();console.log("ğŸ”— æœåŠ¡å™¨è¿æ¥çŠ¶æ€:",o),console.log("ğŸ“š ä»æ•°æ®åº“è·å–è¯—è¯åˆ—è¡¨...");const i=await T.getAll();console.log("âœ… è·å–åˆ°è¯—è¯æ•°æ®:",i.length,"é¦–"),console.log("ğŸ“‹ è¯—è¯åˆ—è¡¨:",i),h.value=i,w.value=!0,i.length===0&&(console.log("ğŸ“ æ•°æ®åº“ä¸ºç©ºï¼Œåˆå§‹åŒ–é»˜è®¤æ•°æ®..."),await a()),console.log("ğŸ‰ è¯—è¯æ•°æ®åŠ è½½å®Œæˆ!")}catch(o){console.error("âŒ åŠ è½½è¯—è¯å¤±è´¥:",o),D.value=o.message||"åŠ è½½è¯—è¯å¤±è´¥",console.log("ğŸ”„ ä½¿ç”¨æœ¬åœ°é»˜è®¤æ•°æ®"),w.value=!1,h.value=f()}finally{C.value=!1}},f=()=>[{title:"é™å¤œæ€",author:"æç™½",dynasty:"å”ä»£",content:"åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚",preview:"åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg",is_favorite:!1},{title:"æ˜¥æ™“",author:"å­Ÿæµ©ç„¶",dynasty:"å”ä»£",content:"æ˜¥çœ ä¸è§‰æ™“ï¼Œå¤„å¤„é—»å•¼é¸Ÿã€‚å¤œæ¥é£é›¨å£°ï¼ŒèŠ±è½çŸ¥å¤šå°‘ã€‚",preview:"æ˜¥çœ ä¸è§‰æ™“ï¼Œå¤„å¤„é—»å•¼é¸Ÿã€‚å¤œæ¥é£é›¨å£°ï¼ŒèŠ±è½çŸ¥å¤šå°‘ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/437f5006c8faaf74d6d7d4197e1d9482.jpg",is_favorite:!1},{title:"ç™»é¹³é›€æ¥¼",author:"ç‹ä¹‹æ¶£",dynasty:"å”ä»£",content:"ç™½æ—¥ä¾å±±å°½ï¼Œé»„æ²³å…¥æµ·æµã€‚æ¬²ç©·åƒé‡Œç›®ï¼Œæ›´ä¸Šä¸€å±‚æ¥¼ã€‚",preview:"ç™½æ—¥ä¾å±±å°½ï¼Œé»„æ²³å…¥æµ·æµã€‚æ¬²ç©·åƒé‡Œç›®ï¼Œæ›´ä¸Šä¸€å±‚æ¥¼ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/43e7125fe4023d89a1774e4416e1ace4.jpg",is_favorite:!1},{title:"æ±Ÿé›ª",author:"æŸ³å®—å…ƒ",dynasty:"å”ä»£",content:"åƒå±±é¸Ÿé£ç»ï¼Œä¸‡å¾„äººè¸ªç­ã€‚å­¤èˆŸè“‘ç¬ ç¿ï¼Œç‹¬é’“å¯’æ±Ÿé›ªã€‚",preview:"åƒå±±é¸Ÿé£ç»ï¼Œä¸‡å¾„äººè¸ªç­ã€‚å­¤èˆŸè“‘ç¬ ç¿ï¼Œç‹¬é’“å¯’æ±Ÿé›ªã€‚",image:"https://ai-public.mastergo.com/ai/img_res/f0be731204399b0b196cea3d7505fdd2.jpg",is_favorite:!1},{title:"æ°´è°ƒæ­Œå¤´",author:"è‹è½¼",dynasty:"å®‹ä»£",content:"æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ã€‚",preview:"æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg",is_favorite:!1},{title:"å£°å£°æ…¢",author:"ææ¸…ç…§",dynasty:"å®‹ä»£",content:"å¯»å¯»è§…è§…ï¼Œå†·å†·æ¸…æ¸…ï¼Œå‡„å‡„æƒ¨æƒ¨æˆšæˆšã€‚ä¹æš–è¿˜å¯’æ—¶å€™ï¼Œæœ€éš¾å°†æ¯ã€‚",preview:"å¯»å¯»è§…è§…ï¼Œå†·å†·æ¸…æ¸…ï¼Œå‡„å‡„æƒ¨æƒ¨æˆšæˆšã€‚ä¹æš–è¿˜å¯’æ—¶å€™ï¼Œæœ€éš¾å°†æ¯ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg",is_favorite:!1},{title:"å¤©å‡€æ²™Â·ç§‹æ€",author:"é©¬è‡´è¿œ",dynasty:"å…ƒä»£",content:"æ¯è—¤è€æ ‘æ˜é¸¦ï¼Œå°æ¡¥æµæ°´äººå®¶ï¼Œå¤é“è¥¿é£ç˜¦é©¬ã€‚å¤•é˜³è¥¿ä¸‹ï¼Œæ–­è‚ äººåœ¨å¤©æ¶¯ã€‚",preview:"æ¯è—¤è€æ ‘æ˜é¸¦ï¼Œå°æ¡¥æµæ°´äººå®¶ï¼Œå¤é“è¥¿é£ç˜¦é©¬ã€‚å¤•é˜³è¥¿ä¸‹ï¼Œæ–­è‚ äººåœ¨å¤©æ¶¯ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/156f26c1f21f943949d6e24ce6c4e10c.jpg",is_favorite:!1},{title:"ä¸Šé‚ª",author:"ä½šå",dynasty:"æ±‰ä»£",content:"ä¸Šé‚ªï¼æˆ‘æ¬²ä¸å›ç›¸çŸ¥ï¼Œé•¿å‘½æ— ç»è¡°ã€‚å±±æ— é™µï¼Œæ±Ÿæ°´ä¸ºç«­ï¼Œå†¬é›·éœ‡éœ‡ï¼Œå¤é›¨é›ªï¼Œå¤©åœ°åˆï¼Œä¹ƒæ•¢ä¸å›ç»ï¼",preview:"ä¸Šé‚ªï¼æˆ‘æ¬²ä¸å›ç›¸çŸ¥ï¼Œé•¿å‘½æ— ç»è¡°ã€‚å±±æ— é™µï¼Œæ±Ÿæ°´ä¸ºç«­ï¼Œå†¬é›·éœ‡éœ‡ï¼Œå¤é›¨é›ªï¼Œå¤©åœ°åˆï¼Œä¹ƒæ•¢ä¸å›ç»ï¼",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg",is_favorite:!1},{title:"å†åˆ«åº·æ¡¥",author:"å¾å¿—æ‘©",dynasty:"ç°ä»£",content:"è½»è½»çš„æˆ‘èµ°äº†ï¼Œæ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼›æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚",preview:"è½»è½»çš„æˆ‘èµ°äº†ï¼Œæ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼›æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/437f5006c8faaf74d6d7d4197e1d9482.jpg",is_favorite:!1},{title:"é•¿æ­Œè¡Œ",author:"ä½šå",dynasty:"æ±‰ä»£",content:"é’é’å›­ä¸­è‘µï¼Œæœéœ²å¾…æ—¥æ™ã€‚é˜³æ˜¥å¸ƒå¾·æ³½ï¼Œä¸‡ç‰©ç”Ÿå…‰è¾‰ã€‚å¸¸æç§‹èŠ‚è‡³ï¼Œç„œé»„åå¶è¡°ã€‚ç™¾å·ä¸œåˆ°æµ·ï¼Œä½•æ—¶å¤è¥¿å½’ï¼Ÿå°‘å£®ä¸åŠªåŠ›ï¼Œè€å¤§å¾’ä¼¤æ‚²ï¼",preview:"é’é’å›­ä¸­è‘µï¼Œæœéœ²å¾…æ—¥æ™ã€‚é˜³æ˜¥å¸ƒå¾·æ³½ï¼Œä¸‡ç‰©ç”Ÿå…‰è¾‰ã€‚å¸¸æç§‹èŠ‚è‡³ï¼Œç„œé»„åå¶è¡°ã€‚ç™¾å·ä¸œåˆ°æµ·ï¼Œä½•æ—¶å¤è¥¿å½’ï¼Ÿå°‘å£®ä¸åŠªåŠ›ï¼Œè€å¤§å¾’ä¼¤æ‚²ï¼",image:"https://ai-public.mastergo.com/ai/img_res/43e7125fe4023d89a1774e4416e1ace4.jpg",is_favorite:!1},{title:"ç›¸æ€",author:"ç‹ç»´",dynasty:"å”ä»£",content:"çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚æ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚",preview:"çº¢è±†ç”Ÿå—å›½ï¼Œæ˜¥æ¥å‘å‡ æã€‚æ„¿å›å¤šé‡‡æ’·ï¼Œæ­¤ç‰©æœ€ç›¸æ€ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/f0be731204399b0b196cea3d7505fdd2.jpg",is_favorite:!1},{title:"æœ›å²³",author:"æœç”«",dynasty:"å”ä»£",content:"å²±å®—å¤«å¦‚ä½•ï¼Ÿé½é²é’æœªäº†ã€‚é€ åŒ–é’Ÿç¥ç§€ï¼Œé˜´é˜³å‰²æ˜æ™“ã€‚è¡èƒ¸ç”Ÿæ›¾äº‘ï¼Œå†³çœ¦å…¥å½’é¸Ÿã€‚ä¼šå½“å‡Œç»é¡¶ï¼Œä¸€è§ˆä¼—å±±å°ã€‚",preview:"å²±å®—å¤«å¦‚ä½•ï¼Ÿé½é²é’æœªäº†ã€‚é€ åŒ–é’Ÿç¥ç§€ï¼Œé˜´é˜³å‰²æ˜æ™“ã€‚è¡èƒ¸ç”Ÿæ›¾äº‘ï¼Œå†³çœ¦å…¥å½’é¸Ÿã€‚ä¼šå½“å‡Œç»é¡¶ï¼Œä¸€è§ˆä¼—å±±å°ã€‚",image:"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg",is_favorite:!1}],a=async()=>{try{const o=f(),i=await T.createBatch(o);h.value=i,console.log("é»˜è®¤è¯—è¯åˆå§‹åŒ–å®Œæˆ")}catch(o){throw console.error("åˆå§‹åŒ–é»˜è®¤è¯—è¯å¤±è´¥:",o),o}},v=g(!1),L=async o=>{try{const i=new Set(h.value.map(_=>`${_.title}-${_.author}`)),r=o.filter(_=>!i.has(`${_.title}-${_.author}`));if(r.length>0){const _=r.map(p=>({title:p.title,author:p.author,dynasty:p.dynasty,content:p.content||p.preview,preview:p.preview||p.content,image:p.image||"https://ai-public.mastergo.com/ai/img_res/48599143c45e1b4cb1d0cd756388f738.jpg",is_favorite:!1}));if(w.value){const p=await T.createBatch(_);h.value=[...h.value,...p]}else h.value=[...h.value,..._];alert(`æˆåŠŸæ·»åŠ  ${r.length} é¦–è¯—è¯ï¼`),v.value=!1}else alert("æ‰€é€‰è¯—è¯å·²å­˜åœ¨ï¼Œæœªæ·»åŠ é‡å¤å†…å®¹ã€‚")}catch(i){console.error("æ·»åŠ è¯—è¯å¤±è´¥:",i),alert(`æ·»åŠ è¯—è¯å¤±è´¥: ${i.message}`)}},K=g(!1),B=g(null),y=g(null);let P=null;const ge=async()=>{if(I.value){K.value=!0,B.value=null,y.value=null,P==null||P.abort(),P=new AbortController;try{const o=await Te({title:I.value.title,author:I.value.author,dynasty:I.value.dynasty,content:I.value.content||I.value.preview||""},P.signal);y.value=o}catch(o){B.value=(o==null?void 0:o.message)||"é‰´èµå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{K.value=!1}}},V=g(!1),N=g(""),_e=()=>V.value=!V.value,ye=()=>N.value="",H=(o,i)=>{switch(o){case"å”è¯—":return i.filter(r=>r.dynasty.includes("å”"));case"å®‹è¯":return i.filter(r=>r.dynasty.includes("å®‹"));case"å…ƒæ›²":return i.filter(r=>r.dynasty.includes("å…ƒ"));case"å¤é£":return i.filter(r=>r.dynasty.includes("å”")||r.dynasty.includes("æ±‰")||r.dynasty.includes("é­æ™‹")||r.dynasty.includes("å…ˆç§¦"));case"ç°ä»£è¯—":return i.filter(r=>r.dynasty.includes("ç°ä»£")||r.dynasty.includes("å½“ä»£")||r.dynasty.includes("æ°‘å›½"));case"ä¹åºœ":return i.filter(r=>r.dynasty.includes("æ±‰")||r.dynasty.includes("é­æ™‹")||r.dynasty.includes("å—åŒ—æœ"));case"ç»å¥":return i.filter(r=>(r.content||r.preview).split(/[ï¼Œã€‚ï¼›ï¼ï¼Ÿ]/).filter(p=>p.trim()).length===4);case"å¾‹è¯—":return i.filter(r=>(r.content||r.preview).split(/[ï¼Œã€‚ï¼›ï¼ï¼Ÿ]/).filter(p=>p.trim()).length===8);default:return i}},fe=M(()=>{const o=N.value.trim(),i=m.value[k.value];let r=H(i.name,h.value);return o&&(r=r.filter(_=>[_.title,_.author,_.dynasty,_.preview||_.content].some(p=>p==null?void 0:p.toLowerCase().includes(o.toLowerCase())))),r}),Y=M(()=>h.value.length),Z=M(()=>h.value.filter(o=>!!o.is_favorite).length),$=M(()=>{const o={};return m.value.forEach(i=>{o[i.name]=H(i.name,h.value).length}),o}),ee=M(()=>{const o={};return h.value.forEach(i=>{o[i.dynasty]=(o[i.dynasty]||0)+1}),Object.entries(o).map(([i,r])=>({dynasty:i,count:r})).sort((i,r)=>r.count-i.count).slice(0,5)}),be=()=>{const o={poems:h.value,favorites:se.value,stats:{totalCount:Y.value,favoritesCount:Z.value,categoryCounts:$.value,topDynasties:ee.value},exportTime:new Date().toISOString()},i=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),r=URL.createObjectURL(i),_=document.createElement("a");_.href=r,_.download=`poem-data-${new Date().toISOString().split("T")[0]}.json`,_.click(),URL.revokeObjectURL(r),alert("æ•°æ®å¯¼å‡ºæˆåŠŸï¼")},we=async()=>{if(confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ”¶è—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚"))try{if(w.value){const o=h.value.filter(i=>i.is_favorite&&i.id);for(const i of o)await T.toggleFavorite(i.id)}else h.value.forEach(o=>{o.is_favorite=!1});alert("æ”¶è—å·²æ¸…ç©ºï¼")}catch(o){console.error("æ¸…ç©ºæ”¶è—å¤±è´¥:",o),alert(`æ¸…ç©ºæ”¶è—å¤±è´¥: ${o.message}`)}},pe=async()=>{await E(),alert("æ•°æ®åˆ·æ–°å®Œæˆï¼")},te=o=>!!o.is_favorite,ke=async o=>{try{if(w.value&&o.id){const i=await T.toggleFavorite(o.id),r=h.value.findIndex(_=>_.id===o.id);r!==-1&&(h.value[r]={...h.value[r],...i,is_favorite:!!i.is_favorite})}else{const i=h.value.findIndex(r=>r.title===o.title&&r.author===o.author);i!==-1&&(h.value[i].is_favorite=!h.value[i].is_favorite)}}catch(i){console.error("åˆ‡æ¢æ”¶è—çŠ¶æ€å¤±è´¥:",i),alert(`æ“ä½œå¤±è´¥: ${i.message}`)}},se=M(()=>h.value.filter(o=>te(o))),Ce=async o=>{if(confirm(`ç¡®å®šè¦åˆ é™¤è¯—è¯ã€Š${o.title}ã€‹å—ï¼Ÿ`))try{w.value&&o.id&&await T.delete(o.id);const i=h.value.findIndex(r=>o.id?r.id===o.id:r.title===o.title&&r.author===o.author);i!==-1&&h.value.splice(i,1),alert("è¯—è¯åˆ é™¤æˆåŠŸï¼")}catch(i){console.error("åˆ é™¤è¯—è¯å¤±è´¥:",i),alert(`åˆ é™¤å¤±è´¥: ${i.message}`)}},Se=g([{icon:"ğŸ ",text:"é¦–é¡µ"},{icon:"ğŸ“š",text:"åˆ†ç±»"},{icon:"â¤ï¸",text:"æ”¶è—"},{icon:"ğŸ‘¤",text:"æˆ‘çš„"}]),Q=g(0),Pe=o=>Q.value=o,je=()=>window.history.length>1?window.history.back():alert("æ²¡æœ‰ä¸Šä¸€é¡µ"),Ee=o=>k.value=o,Le=o=>{Q.value=0,k.value=o,window.scrollTo({top:0,behavior:"smooth"})},I=g(null),J=g(!1),De=o=>{I.value=o,J.value=!0,y.value=null,B.value=null},Fe=()=>{J.value=!1,I.value=null,P&&(P.abort(),P=null)},q=g(0),oe=g(null);let R=null;const G=o=>{var r;q.value=o;const i=(r=oe.value)==null?void 0:r.children.item(o);i==null||i.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})},ae=()=>G((q.value+1)%b.value.length),Ae=()=>G((q.value-1+b.value.length)%b.value.length),W=()=>{R=window.setInterval(ae,5e3)},ie=()=>{R&&(clearInterval(R),R=null)},Ie=()=>{R||W()};Be(async()=>{W(),await E()}),ue(()=>{ie()});const ne={authStore:n,router:t,handleLogout:F,carouselItems:b,categories:m,activeCategory:k,isServerConnected:w,isLoading:C,errorMessage:D,poems:h,loadPoemsFromDatabase:E,getDefaultPoems:f,initializeDefaultPoems:a,showOnlineSearch:v,handleAddPoems:L,appreciationLoading:K,appreciationError:B,appreciation:y,get appreciationAbort(){return P},set appreciationAbort(o){P=o},fetchAppreciation:ge,showSearch:V,searchQuery:N,toggleSearch:_e,clearSearch:ye,getFilteredPoemsByCategory:H,filteredPoems:fe,totalCount:Y,favoritesCount:Z,categoryCounts:$,topDynasties:ee,exportData:be,clearAllFavorites:we,refreshData:pe,isFav:te,toggleFav:ke,favList:se,deletePoem:Ce,footerItems:Se,activeFooter:Q,switchTab:Pe,goBack:je,selectCategory:Ee,viewCategoryPoems:Le,selectedPoem:I,showDetail:J,viewPoemDetail:De,closeDetail:Fe,activeSlide:q,carouselTrack:oe,get timer(){return R},set timer(o){R=o},jumpSlide:G,nextSlide:ae,prevSlide:Ae,startAuto:W,pauseCarousel:ie,resumeCarousel:Ie,OnlineSearch:rt};return Object.defineProperty(ne,"__isScriptSetup",{enumerable:!1,value:!0}),ne}}),ct={class:"page"},dt={class:"header"},ut={class:"header-actions"},vt={class:"user-info"},ht={class:"username"},mt={key:0,class:"search-bar"},gt=["onKeydown"],_t={class:"carousel-track",ref:"carouselTrack"},yt=["src"],ft={class:"carousel-text"},bt={class:"poem-line"},wt={class:"author"},pt={class:"dots"},kt=["onClick","aria-label"],Ct={class:"category-scroll",role:"tablist","aria-label":"åˆ†ç±»å¯¼èˆª"},St={class:"category-container"},Pt=["onClick","aria-selected","title"],jt={key:1,class:"status-bar"},Et={key:2,class:"loading-overlay"},Lt={class:"content-list"},Dt=["onClick","aria-label"],Ft=["src","alt"],At={class:"poem-info"},It={class:"poem-title"},xt={class:"poem-actions"},Ot=["aria-pressed","onClick","title"],Bt=["onClick"],Rt={class:"poem-author"},Tt={class:"poem-preview"},Mt={key:0,class:"empty"},Kt={key:1,class:"category-panel"},qt={class:"category-grid"},zt=["onClick"],Ut={class:"category-icon"},Vt={class:"category-info"},Nt={class:"category-count"},Ht={class:"category-desc"},Qt=["onClick"],Jt=["src","alt"],Gt={class:"poem-info"},Wt={class:"poem-title"},Xt={class:"poem-actions"},Yt=["onClick"],Zt=["onClick"],$t={class:"poem-author"},es={class:"poem-preview"},ts={key:0,class:"empty"},ss={key:3,class:"profile-panel"},os={class:"user-card"},as={class:"user-info"},is={class:"user-desc"},ns={key:0},rs={class:"stats-grid"},ls={class:"stat-card"},cs={class:"stat-info"},ds={class:"stat-number"},us={class:"stat-card"},vs={class:"stat-info"},hs={class:"stat-number"},ms={class:"stat-card"},gs={class:"stat-info"},_s={class:"stat-number"},ys={class:"stat-card"},fs={class:"stat-info"},bs={class:"stat-number"},ws={class:"chart-section"},ps={class:"chart-container"},ks=["title"],Cs={class:"chart-label"},Ss={class:"chart-count"},Ps={class:"dynasty-section"},js={class:"dynasty-tags"},Es={class:"footer",role:"tablist","aria-label":"åº•éƒ¨å¯¼èˆª"},Ls=["onClick","aria-selected"],Ds={class:"footer-icon"},Fs={class:"modal"},As={class:"modal-header"},Is={class:"modal-actions"},xs=["disabled"],Os={class:"modal-body"},Bs=["src","alt"],Rs={class:"modal-author"},Ts={class:"modal-preview"},Ms={key:0,class:"appreciation"},Ks={key:0,class:"loading"},qs={key:1,class:"error"},zs={class:"block"},Us={class:"block-content"},Vs={class:"block"},Ns={class:"block-content"},Hs={class:"block"},Qs={class:"block-content"},Js={class:"block"},Gs={class:"block-content"};function Ws(u,s,n,t,F,b){var m,k,w,C,D,h,E,f;return d(),c("div",ct,[e("div",dt,[e("button",{class:"icon-btn",onClick:t.goBack,"aria-label":"è¿”å›"},"â†"),s[4]||(s[4]=e("div",{class:"title"},"è¯—è¯é‰´èµ",-1)),e("div",ut,[e("button",{class:"icon-btn",onClick:t.toggleSearch,"aria-label":"æœç´¢"},"ğŸ”"),e("div",vt,[e("span",ht,"ğŸ‘¤ "+l((m=t.authStore.user)==null?void 0:m.username),1),e("button",{class:"logout-btn",onClick:t.handleLogout,title:"é€€å‡ºç™»å½•"},"é€€å‡º")])])]),t.showSearch?(d(),c("div",mt,[he(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.searchQuery=a),type:"text",class:"search-input",placeholder:"æœç´¢ï¼šæ ‡é¢˜/ä½œè€…/æœä»£/å†…å®¹",onKeydown:s[1]||(s[1]=U(a=>t.showSearch=!1,["esc"])),"aria-label":"æœç´¢è¾“å…¥"},null,544),[[me,t.searchQuery]]),e("button",{class:"search-clear",onClick:t.clearSearch},"æ¸…ç©º"),e("button",{class:"online-search-btn",onClick:s[2]||(s[2]=a=>t.showOnlineSearch=!0)},"åœ¨çº¿æœç´¢")])):S("",!0),e("div",{class:"carousel",onMouseenter:t.pauseCarousel,onMouseleave:t.resumeCarousel,onKeydown:[U(O(t.prevSlide,["prevent"]),["left"]),U(O(t.nextSlide,["prevent"]),["right"])],tabindex:"0","aria-label":"è½®æ’­å›¾"},[e("div",_t,[(d(!0),c(j,null,A(t.carouselItems,(a,v)=>(d(),c("div",{class:"carousel-item",key:v},[e("img",{src:a.image,class:"carousel-image",alt:"è½®æ’­å›¾ç‰‡"},null,8,yt),e("div",ft,[e("div",bt,l(a.line),1),e("div",wt,l(a.author),1)])]))),128))],512),e("div",pt,[(d(!0),c(j,null,A(t.carouselItems,(a,v)=>(d(),c("button",{key:v,class:z(["dot",{active:v===t.activeSlide}]),onClick:L=>t.jumpSlide(v),"aria-label":`è·³è½¬åˆ°ç¬¬${v+1}å¼ `},null,10,kt))),128))])],40,gt),e("div",Ct,[e("div",St,[(d(!0),c(j,null,A(t.categories,(a,v)=>(d(),c("button",{key:v,class:z(["category-item",{active:t.activeCategory===v}]),onClick:L=>t.selectCategory(v),role:"tab","aria-selected":t.activeCategory===v,title:a.description},l(a.icon)+" "+l(a.name),11,Pt))),128))])]),t.isServerConnected?S("",!0):(d(),c("div",jt,[...s[5]||(s[5]=[e("div",{class:"status-warning"}," âš ï¸ æ•°æ®åº“æœªè¿æ¥ï¼Œå½“å‰ä½¿ç”¨æœ¬åœ°æ•°æ® ",-1)])])),t.isLoading?(d(),c("div",Et,[...s[6]||(s[6]=[e("div",{class:"loading-content"},[e("div",{class:"spinner"}),e("p",null,"æ­£åœ¨åŠ è½½è¯—è¯...")],-1)])])):S("",!0),e("div",Lt,[t.activeFooter===0?(d(),c(j,{key:0},[(d(!0),c(j,null,A(t.filteredPoems,(a,v)=>(d(),c("div",{class:"poem-card",key:v,onClick:L=>t.viewPoemDetail(a),"aria-label":`æŸ¥çœ‹è¯—è¯ï¼š${a.title}`},[e("img",{src:a.image,class:"poem-image",alt:a.title},null,8,Ft),e("div",At,[e("div",It,[X(l(a.title)+" ",1),e("div",xt,[e("button",{class:"fav-btn","aria-pressed":t.isFav(a),onClick:O(L=>t.toggleFav(a),["stop"]),title:t.isFav(a)?"å–æ¶ˆæ”¶è—":"æ”¶è—"},l(t.isFav(a)?"ğŸ’›":"ğŸ¤"),9,Ot),t.isServerConnected?(d(),c("button",{key:0,class:"delete-btn",onClick:O(L=>t.deletePoem(a),["stop"]),title:"åˆ é™¤è¯—è¯"}," ğŸ—‘ï¸ ",8,Bt)):S("",!0)])]),e("div",Rt,l(a.author)+" Â· "+l(a.dynasty),1),e("div",Tt,l(a.preview),1)])],8,Dt))),128)),t.filteredPoems.length===0?(d(),c("div",Mt,"æœªæ‰¾åˆ°ç›¸å…³è¯—è¯")):S("",!0)],64)):t.activeFooter===1?(d(),c("div",Kt,[s[7]||(s[7]=e("h3",null,"è¯—è¯åˆ†ç±»",-1)),e("div",qt,[(d(!0),c(j,null,A(t.categories,(a,v)=>(d(),c("div",{key:v,class:"category-card",onClick:L=>t.viewCategoryPoems(v)},[e("div",Ut,l(a.icon),1),e("div",Vt,[e("h4",null,l(a.name),1),e("p",Nt,l(t.categoryCounts[a.name])+" é¦–",1),e("p",Ht,l(a.description),1)])],8,zt))),128))]),s[8]||(s[8]=e("p",{class:"hint"},"ç‚¹å‡»åˆ†ç±»å¡ç‰‡ï¼Œå°†ç›´æ¥è·³è½¬åˆ°å¯¹åº”åˆ†ç±»çš„è¯—è¯é¡µé¢ï¼›å³ä¸Šè§’å¯æœç´¢æ ‡é¢˜/ä½œè€…/æœä»£/å†…å®¹ã€‚",-1))])):t.activeFooter===2?(d(),c(j,{key:2},[(d(!0),c(j,null,A(t.favList,(a,v)=>(d(),c("div",{class:"poem-card",key:v,onClick:L=>t.viewPoemDetail(a)},[e("img",{src:a.image,class:"poem-image",alt:a.title},null,8,Jt),e("div",Gt,[e("div",Wt,[X(l(a.title)+" ",1),e("div",Xt,[e("button",{class:"fav-btn",onClick:O(L=>t.toggleFav(a),["stop"])},"ğŸ’›",8,Yt),t.isServerConnected?(d(),c("button",{key:0,class:"delete-btn",onClick:O(L=>t.deletePoem(a),["stop"]),title:"åˆ é™¤è¯—è¯"}," ğŸ—‘ï¸ ",8,Zt)):S("",!0)])]),e("div",$t,l(a.author)+" Â· "+l(a.dynasty),1),e("div",es,l(a.preview),1)])],8,Qt))),128)),t.favList.length===0?(d(),c("div",ts,"è¿˜æ²¡æœ‰æ”¶è—çš„è¯—è¯")):S("",!0)],64)):(d(),c("div",ss,[e("div",os,[s[9]||(s[9]=e("div",{class:"user-avatar"},"ğŸ“š",-1)),e("div",as,[e("h3",null,l(t.authStore.isAuthenticated?(k=t.authStore.user)==null?void 0:k.username:"è¯—è¯çˆ±å¥½è€…"),1),e("p",is,[X(l(t.authStore.isAuthenticated?"æ¬¢è¿å›æ¥ï¼":"è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½")+" ",1),t.totalCount>0?(d(),c("span",ns,"å·²æ”¶å½• "+l(t.totalCount)+" é¦–è¯—è¯",1)):S("",!0)])])]),t.authStore.isAuthenticated?(d(),c(j,{key:0},[e("div",rs,[e("div",ls,[s[11]||(s[11]=e("div",{class:"stat-icon"},"ğŸ“–",-1)),e("div",cs,[e("div",ds,l(t.totalCount),1),s[10]||(s[10]=e("div",{class:"stat-label"},"è¯—è¯æ€»æ•°",-1))])]),e("div",us,[s[13]||(s[13]=e("div",{class:"stat-icon"},"â¤ï¸",-1)),e("div",vs,[e("div",hs,l(t.favoritesCount),1),s[12]||(s[12]=e("div",{class:"stat-label"},"æ”¶è—æ•°é‡",-1))])]),e("div",ms,[s[15]||(s[15]=e("div",{class:"stat-icon"},"ğŸ·ï¸",-1)),e("div",gs,[e("div",_s,l(Object.keys(t.categoryCounts).length),1),s[14]||(s[14]=e("div",{class:"stat-label"},"åˆ†ç±»æ•°é‡",-1))])]),e("div",ys,[s[17]||(s[17]=e("div",{class:"stat-icon"},"ğŸ“Š",-1)),e("div",fs,[e("div",bs,l(Math.round(t.favoritesCount/t.totalCount*100)||0)+"%",1),s[16]||(s[16]=e("div",{class:"stat-label"},"æ”¶è—æ¯”ä¾‹",-1))])])]),e("div",ws,[s[18]||(s[18]=e("h4",null,"ğŸ“ˆ åˆ†ç±»åˆ†å¸ƒ",-1)),e("div",ps,[(d(!0),c(j,null,A(t.categories,(a,v)=>(d(),c("div",{key:v,class:"chart-bar",style:re({width:`${t.categoryCounts[a.name]/t.totalCount*100||0}%`}),title:`${a.name}: ${t.categoryCounts[a.name]} é¦–`},[e("span",Cs,l(a.icon)+" "+l(a.name),1),e("span",Ss,l(t.categoryCounts[a.name]),1)],12,ks))),128))])]),e("div",Ps,[s[19]||(s[19]=e("h4",null,"ğŸ›ï¸ çƒ­é—¨æœä»£",-1)),e("div",js,[(d(!0),c(j,null,A(t.topDynasties,(a,v)=>(d(),c("span",{key:v,class:z(["dynasty-tag",{"top-dynasty":v<3}])},l(a.dynasty)+" ("+l(a.count)+") ",3))),128))])]),e("div",{class:"quick-actions"},[s[20]||(s[20]=e("h4",null,"âš¡ å¿«é€Ÿæ“ä½œ",-1)),e("div",{class:"action-buttons"},[e("button",{class:"action-btn",onClick:t.exportData}," ğŸ“¥ å¯¼å‡ºæ•°æ® "),e("button",{class:"action-btn",onClick:t.clearAllFavorites}," ğŸ—‘ï¸ æ¸…ç©ºæ”¶è— "),e("button",{class:"action-btn",onClick:t.refreshData}," ğŸ”„ åˆ·æ–°æ•°æ® ")])])],64)):S("",!0)]))]),e("div",Es,[(d(!0),c(j,null,A(t.footerItems,(a,v)=>(d(),c("div",{class:z(["footer-item",{active:t.activeFooter===v}]),key:v,onClick:L=>t.switchTab(v),role:"tab","aria-selected":t.activeFooter===v},[e("div",Ds,l(a.icon),1),e("div",{class:"footer-text",style:re({color:t.activeFooter===v?"#c9a76f":"#999"})},l(a.text),5)],10,Ls))),128))]),t.showDetail?(d(),c("div",{key:3,class:"modal-mask",onClick:O(t.closeDetail,["self"]),"aria-modal":"true",role:"dialog"},[e("div",Fs,[e("div",As,[e("h4",null,l((w=t.selectedPoem)==null?void 0:w.title),1),e("div",Is,[e("button",{class:"action-btn",onClick:t.fetchAppreciation,disabled:t.appreciationLoading},l(t.appreciationLoading?"é‰´èµä¸­â€¦":"æ™ºèƒ½é‰´èµ"),9,xs),e("button",{class:"icon-btn",onClick:t.closeDetail,"aria-label":"å…³é—­"},"âœ–")])]),e("div",Os,[e("img",{src:(C=t.selectedPoem)==null?void 0:C.image,class:"modal-image",alt:(D=t.selectedPoem)==null?void 0:D.title},null,8,Bs),e("p",Rs,l((h=t.selectedPoem)==null?void 0:h.author)+" Â· "+l((E=t.selectedPoem)==null?void 0:E.dynasty),1),e("p",Ts,l((f=t.selectedPoem)==null?void 0:f.preview),1),t.appreciation||t.appreciationLoading||t.appreciationError?(d(),c("div",Ms,[s[25]||(s[25]=e("h5",null,"è¯—è¯é‰´èµ",-1)),t.appreciationLoading?(d(),c("div",Ks,"æ­£åœ¨è§£æè¯—è¯æ„å¢ƒä¸ä¿®è¾â€¦")):t.appreciationError?(d(),c("div",qs,l(t.appreciationError),1)):t.appreciation?(d(),c(j,{key:2},[e("section",zs,[s[21]||(s[21]=e("div",{class:"block-title"},"æ„å¢ƒä¸æƒ…æ„Ÿ",-1)),e("p",Us,l(t.appreciation.mood),1)]),e("section",Vs,[s[22]||(s[22]=e("div",{class:"block-title"},"ä¿®è¾ä¸æŠ€å·§",-1)),e("p",Ns,l(t.appreciation.rhetoric),1)]),e("section",Hs,[s[23]||(s[23]=e("div",{class:"block-title"},"åˆ›ä½œèƒŒæ™¯",-1)),e("p",Qs,l(t.appreciation.background),1)]),e("section",Js,[s[24]||(s[24]=e("div",{class:"block-title"},"ç»¼åˆç‚¹è¯„",-1)),e("p",Gs,l(t.appreciation.commentary),1)])],64)):S("",!0)])):S("",!0)])])])):S("",!0),Re(t.OnlineSearch,{show:t.showOnlineSearch,onClose:s[3]||(s[3]=a=>t.showOnlineSearch=!1),onAddPoems:t.handleAddPoems},null,8,["show"])])}const Ys=ve(lt,[["render",Ws],["__scopeId","data-v-bd9bb22b"],["__file","D:/æ‚ç‰©/peom/src/pages/home/Home.vue"]]);export{Ys as default};
